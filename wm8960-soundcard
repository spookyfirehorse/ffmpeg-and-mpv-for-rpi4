pi 6.18
sudo nano /boot/firmware/config.txt
dtoverlay=vc4-kms-v3d,cma-512,noaudio
max_framebuffers=2
camera_auto_detect=0
dtoverlay=imx708
vc4.tv_norm=PAL
dtoverlay=i2s
dtparam=i2c_arm=on
dtoverlay=wm8960-final-fix
sudo systemctl disable  wm8960-soundcard.service
sudo nano /etc/modprobe.d/blacklist-wm8960.conf
blacklist snd_soc_wm8960_soundcard
blacklist snd_bcm2835
sudo nano /etc/modules
i2c-dev
snd-soc-wm8960
sudo cp wm8960-kernel-6.18/wm8960-* /boot/firmware/overlays/


pi 6.12
sudo nano /boot/firmware/config.txt
dtoverlay=vc4-kms-v3d,cma-512,noaudio
max_framebuffers=2
camera_auto_detect=0
dtoverlay=imx708
vc4.tv_norm=PAL
dtoverlay=i2s
dtparam=i2c_arm=on
dtoverlay=wm8960-clock-fix
gpio=17=op,dh
sudo systemctl disable  wm8960-soundcard.service
sudo nano /etc/modprobe.d/blacklist-wm8960.conf
blacklist snd_soc_wm8960_soundcard
blacklist snd_bcm2835
sudo nano /etc/modules
i2c-dev
snd-soc-wm8960
kernel 6.18

#!/bin/bash

# 1. Boot-Konfiguration anpassen
echo "Konfiguriere /boot/firmware/config.txt..."
sudo tee /boot/firmware/config.txt > /dev/null <<EOF
dtoverlay=vc4-kms-v3d,cma-512,noaudio
max_framebuffers=2
camera_auto_detect=0
dtoverlay=imx708
vc4.tv_norm=PAL
dtoverlay=i2s
dtparam=i2c_arm=on
dtoverlay=wm8960-final-fix
EOF

# 2. Service deaktivieren
echo "Deaktiviere wm8960-soundcard.service..."
sudo systemctl disable wm8960-soundcard.service

# 3. Kernel-Module blacklisten
echo "Erstelle Blacklist fÃ¼r Module..."
sudo tee /etc/modprobe.d/blacklist-wm8960.conf > /dev/null <<EOF
blacklist snd_soc_wm8960_soundcard
blacklist snd_bcm2835
EOF

# 4. Erforderliche Module laden
echo "Aktualisiere /etc/modules..."
sudo tee /etc/modules > /dev/null <<EOF
i2c-dev
snd-soc-wm8960
EOF
sudo cp wm8960-kernel-6.18/wm8960-* /boot/firmware/overlays/
echo "Fertig! Bitte starte das System mit 'sudo reboot' neu."


cat << 'EOF' > setup.sh
#!/bin/bash
sudo tee /boot/firmware/config.txt > /dev/null <<EOC
dtoverlay=vc4-kms-v3d,cma-512,noaudio
max_framebuffers=2
camera_auto_detect=0
dtoverlay=imx708
vc4.tv_norm=PAL
dtoverlay=i2s
dtparam=i2c_arm=on
dtoverlay=wm8960-clock-fix
gpio=17=op,dh
EOC
sudo systemctl disable wm8960-soundcard.service 2>/dev/null
sudo tee /etc/modprobe.d/blacklist-wm8960.conf > /dev/null <<EOM
blacklist snd_soc_wm8960_soundcard
blacklist snd_bcm2835
EOM
sudo tee /etc/modules > /dev/null <<EON
i2c-dev
snd-soc-wm8960
EON
echo "Erledigt. Bitte mit 'sudo reboot' neu starten."
EOF
chmod +x setup.sh && ./setup.sh
